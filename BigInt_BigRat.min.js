var bigInt=function(){var e=1e7,t=7,n={positive:!1,negative:!0},r=function(e,t){var n=e.value,r=t.value,i=n.length>r.length?n.length:r.length;for(var s=0;s<i;s++)n[s]=n[s]||0,r[s]=r[s]||0;for(var s=i-1;s>=0;s--){if(n[s]!==0||r[s]!==0)break;n.pop(),r.pop()}n.length||(n=[0],r=[0]),e.value=n,t.value=r},i=function(e,s){if(typeof e=="object")return e;e+="";var u=n.positive,a=[];e[0]==="-"&&(u=n.negative,e=e.slice(1));var e=e.split("e");if(e.length>2)throw new Error("Invalid integer");if(e[1]){var f=e[1];f[0]==="+"&&(f=f.slice(1)),f=i(f);if(f.lesser(0))throw new Error("Cannot include negative exponent part for integers");while(f.notEquals(0))e[0]+="0",f=f.prev()}e=e[0],e==="-0"&&(e="0");var l=/^([0-9][0-9]*)$/.test(e);if(!l)throw new Error("Invalid integer");while(e.length){var c=e.length>t?e.length-t:0;a.push(+e.slice(c)),e=e.slice(0,c)}var h=o(a,u);return s&&r(s,h),h},s=function(e,t){var e=o(e,n.positive),t=o(t,n.positive);if(e.equals(0))throw new Error("Cannot divide by 0");var r=0;do{var i=1,s=o(e.value,n.positive),u=s.times(10);while(u.lesser(t))s=u,i*=10,u=u.times(10);while(s.lesserOrEquals(t))t=t.minus(s),r+=i}while(e.lesserOrEquals(t));return{remainder:t.value,result:r}},o=function(f,l){var c={value:f,sign:l},h={value:f,sign:l,negate:function(e){var t=e||c;return o(t.value,!t.sign)},abs:function(e){var t=e||c;return o(t.value,n.positive)},add:function(t,s){var u,a=c,f;s?(a=i(t))&&(f=i(s)):f=i(t,a),u=a.sign;if(a.sign!==f.sign)return a=o(a.value,n.positive),f=o(f.value,n.positive),u===n.positive?h.subtract(a,f):h.subtract(f,a);r(a,f);var l=a.value,p=f.value,d=[],v=0;for(var m=0;m<l.length||v>0;m++){var g=(l[m]||0)+(p[m]||0)+v;v=g>=e?1:0,g-=v*e,d.push(g)}return o(d,u)},plus:function(e,t){return h.add(e,t)},subtract:function(t,r){var s=c,u;r?(s=i(t))&&(u=i(r)):u=i(t,s);if(s.sign!==u.sign)return h.add(s,h.negate(u));if(s.sign===n.negative)return h.subtract(h.negate(u),h.negate(s));if(h.compare(s,u)===-1)return h.negate(h.subtract(u,s));var a=s.value,f=u.value,l=[],p=0;for(var d=0;d<a.length;d++){a[d]-=p,p=a[d]<f[d]?1:0;var v=p*e+a[d]-f[d];l.push(v)}return o(l,n.positive)},minus:function(e,t){return h.subtract(e,t)},multiply:function(t,n){var r,s=c,u;n?(s=i(t))&&(u=i(n)):u=i(t,s),r=s.sign!==u.sign;var a=s.value,f=u.value,l=[];for(var h=0;h<a.length;h++){l[h]=[];var p=h;while(p--)l[h].push(0)}var d=0;for(var h=0;h<a.length;h++){var v=a[h];for(var p=0;p<f.length||d>0;p++){var m=f[p],g=m?v*m+d:d;d=g>e?Math.floor(g/e):0,g-=d*e,l[h].push(g)}}var y=-1;for(var h=0;h<l.length;h++){var b=l[h].length;b>y&&(y=b)}var w=[],d=0;for(var h=0;h<y||d>0;h++){var E=d;for(var p=0;p<l.length;p++)E+=l[p][h]||0;d=E>e?Math.floor(E/e):0,E-=d*e,w.push(E)}return o(w,r)},times:function(e,t){return h.multiply(e,t)},divmod:function(e,t){var r,u=c,a;t?(u=i(e))&&(a=i(t)):a=i(e,u),r=u.sign!==a.sign;if(o(u.value,u.sign).equals(0))return{quotient:o([0],n.positive),remainder:o([0],n.positive)};if(a.equals(0))throw new Error("Cannot divide by zero");var f=u.value,l=a.value,h=[],p=[];for(var d=f.length-1;d>=0;d--){var e=[f[d]].concat(p),v=s(l,e);h.push(v.result),p=v.remainder}return h.reverse(),{quotient:o(h,r),remainder:o(p,u.sign)}},divide:function(e,t){return h.divmod(e,t).quotient},over:function(e,t){return h.divide(e,t)},mod:function(e,t){return h.divmod(e,t).remainder},pow:function(e,t){var n=c,r;t?(n=i(e))&&(r=i(t)):r=i(e,n);var s=n,f=r;if(f.lesser(0))return u;if(f.equals(0))return a;var l=o(s.value,s.sign);if(f.mod(2).equals(0)){var h=l.pow(f.over(2));return h.times(h)}return l.times(l.pow(f.minus(1)))},next:function(e){var t=e||c;return h.add(t,1)},prev:function(e){var t=e||c;return h.subtract(t,1)},compare:function(e,t){var s=c,o;t?(s=i(e))&&(o=i(t,s)):o=i(e,s),r(s,o);if(s.value.length===1&&o.value.length===1&&s.value[0]===0&&o.value[0]===0)return 0;if(o.sign!==s.sign)return s.sign===n.positive?1:-1;var u=s.sign===n.positive?1:-1,a=s.value,f=o.value;for(var l=a.length-1;l>=0;l--){if(a[l]>f[l])return 1*u;if(f[l]>a[l])return-1*u}return 0},compareAbs:function(e,t){var r=c,s;return t?(r=i(e))&&(s=i(t,r)):s=i(e,r),r.sign=s.sign=n.positive,h.compare(r,s)},equals:function(e,t){return h.compare(e,t)===0},notEquals:function(e,t){return!h.equals(e,t)},lesser:function(e,t){return h.compare(e,t)<0},greater:function(e,t){return h.compare(e,t)>0},greaterOrEquals:function(e,t){return h.compare(e,t)>=0},lesserOrEquals:function(e,t){return h.compare(e,t)<=0},isPositive:function(e){var t=e||c;return t.sign===n.positive},isNegative:function(e){var t=e||c;return t.sign===n.negative},isEven:function(e){var t=e||c;return t.value[0]%2===0},isOdd:function(e){var t=e||c;return t.value[0]%2===1},toString:function(r){var i=r||c,s="",o=i.value.length;while(o--)s+=(e.toString()+i.value[o]).slice(-t);while(s[0]==="0")s=s.slice(1);s.length||(s="0");var u=i.sign===n.positive?"":"-";return u+s},toJSNumber:function(e){return+h.toString(e)},valueOf:function(e){return h.toJSNumber(e)}};return h},u=o([0],n.positive),a=o([1],n.positive),f=o([1],n.negative),l=function(e){return typeof e=="undefined"?u:i(e)};return l.zero=u,l.one=a,l.minusOne=f,l}();typeof module!="undefined"&&(module.exports=bigInt);var bigRat=function(){function e(t,n){return n.equals(0)?t:e(n,t.mod(n))}function t(t,n){return t.times(n).divide(e(t,n))}function n(i,o,u){o=o||bigInt(1),u=u||!1;var a={numerator:i,denominator:o,num:i,denom:o,reduce:function(){var t=e(a.num,a.denom),r=a.num.divide(t),i=a.denom.divide(t);i.lesser(0)&&(r=r.times(-1),i=i.times(-1));if(i.equals(0))throw"Denominator cannot be 0.";return n(r,i,!0)},abs:function(){return a.isPositive()?a:a.negate()},multiply:function(e,t){return e=r(e,t),n(a.num.times(e.num),a.denom.times(e.denom))},times:function(e,t){return a.multiply(e,t)},divide:function(e,t){return e=r(e,t),n(a.num.times(e.denom),a.denom.times(e.num))},over:function(e,t){return a.divide(e,t)},mod:function(e,t){var e=r(e,t);return a.minus(e.times(a.over(e).floor()))},add:function(e,i){e=r(e,i);var s=t(a.denom,e.denom),o=s.divide(a.denom),u=s.divide(e.denom);return o=a.num.times(o),u=e.num.times(u),n(o.add(u),s)},plus:function(e,t){return a.add(e,t)},negate:function(){var e=bigInt.zero.minus(a.num);return n(e,a.denom)},subtract:function(e,t){return e=r(e,t),a.add(e.negate())},minus:function(e,t){return a.subtract(e,t)},isPositive:function(){return a.num.isPositive()},isNegative:function(){return!a.isPositive()},isZero:function(){return a.equals(0,1)},compare:function(e,t){e=r(e,t);if(a.num.equals(e.num)&&a.denom.equals(e.denom))return 0;var n=a.denom.times(e.denom),i=n.greater(0)?1:-1;return a.num.times(e.denom).greater(e.num.times(a.denom))?i:-i},equals:function(e,t){return a.compare(e,t)===0},notEquals:function(e,t){return!a.equals(e,t)},lesser:function(e,t){return a.compare(e,t)<0},lesserOrEquals:function(e,t){return a.compare(e,t)<=0},greater:function(e,t){return a.compare(e,t)>0},greaterOrEquals:function(e,t){return a.compare(e,t)>=0},floor:function(e){var t=a.num.over(a.denom);return e?t:n(t)},ceil:function(e){var t=a.num.divmod(a.denom),r;return r=t.quotient,t.remainder.notEquals(0)&&(r=r.add(1)),e?r:n(r)},round:function(e){return a.add(1,2).floor(e)},toString:function(){var e=a.reduce();return e.num.toString()+"/"+e.denom.toString()},valueOf:function(){return a.num/a.denom},toDecimal:function(e){e=e||10;var t=a.num.divmod(a.denom),n=t.quotient.toString(),r=s(t.remainder,a.denom),i="";while(i.length<=e){var o;for(o=0;o<10;o++)if(s(i+o,"1"+Array(i.length+2).join("0")).greater(r)){o--;break}i+=o}while(i.slice(-1)==="0")i=i.slice(0,-1);return i===""?n:n+"."+i}};return u?a:a.reduce()}function r(e,t){return s(e,t)}function i(e){var t=e.split("e");if(t.length>2)throw new Error("Invalid input: too many 'e' tokens");if(t.length>1){var r=!0;t[1][0]==="-"&&(t[1]=t[1].slice(1),r=!1),t[1][0]==="+"&&(t[1]=t[1].slice(1));var s=i(t[0]),o=n(bigInt(10).pow(t[1]));return r?s.times(o):s.over(o)}t=e.split(".");if(t.length>2)throw new Error("Invalid input: too many '.' tokens");if(t.length>1){var u=n(bigInt(t[0])),a=t[1].length;while(t[1][0]==="0")t[1]=t[1].slice(1);var f="1"+Array(a+1).join("0"),l=n(bigInt(t[1]),bigInt(f));return u.add(l)}return n(bigInt(e))}function s(e,t){if(!e)return n(bigInt(0));if(t)return n(bigInt(e),bigInt(t));if(typeof e=="object")return e.instanceofBigInt?n(e):e;var r,s,o=e+"",u=o.split("/");if(u.length>2)throw new Error("Invalid input: too many '/' tokens");if(u.length>1){var a=u[0].split("_");if(a.length>2)throw new Error("Invalid input: too many '_' tokens");if(a.length>1){var f=a[0][0]!=="-";return r=bigInt(a[0]).times(u[1]),f?r=r.add(a[1]):r=r.subtract(a[1]),s=bigInt(u[1]),n(r,s).reduce()}return n(bigInt(u[0]),bigInt(u[1]))}return i(o)}return typeof require!="undefined"&&(bigInt=require("big-integer")),s.zero=s(0),s.one=s(1),s.minusOne=s(-1),s}();typeof module!="undefined"&&module.hasOwnProperty("exports")&&(module.exports=bigRat);